#!/bin/sh
# X11 environment

# SDL Options
# Use pulse audio for SDL audio
export SDL_VIDEO_MINIMIZE_ON_FOCUS_LOSS=0
export SDL_AUDIODRIVER=pulse

# Hardware Accel
#
# For AMD
export LIBVA_DRIVER_NAME=radeonsi

# Use S3TC texture compression
export force_s3tc_enable=true

# Help with Pulse audio crackling in some programs
export PULSE_LATENCY_MSEC=60

if command -v qt5ct > /dev/null 2>&1; then
  export QT_QPA_PLATFORMTHEME=qt5ct
fi

if command -v kvantummanager > /dev/null 2>&1; then
  export QT_STYLE_OVERRIDE=kvantum
fi

# shellcheck disable=SC1091
[ -f "${HOME}"/.bash_profile ] && . "${HOME}"/.bash_profile

# No idea if this is kosher but this is what worked to fix the rofi theme problem.
# Without these lines using rofi to launch systemsettings resulted in unthemed systemsettings
# export KDE_FULL_SESSION=true
# export XDG_CURRENT_DESKTOP=KDE

# X11 support for Gnome and GTK
export XDG_SESSION_TYPE=x11
export GDK_BACKEND=x11

# Setup xhost for localhost
if command -v whoami > /dev/null 2>&1 && command -v xhost > /dev/null 2>&1; then
  xhost "+si:localuser:$(whoami)"
fi


# Clean source xrdb config
if command -v xrdb > /dev/null 2>&1 && [ -f "${HOME}"/.Xresources ]; then
  xrdb "${HOME}"/.Xresources &
fi

# Disable the terminal bell noise
if command -v xset > /dev/null 2>&1; then
  xset -b &
fi

# Keybindings
if command -v xbindkeys > /dev/null 2>&1; then
  xbindkeys &
fi

# Flameshot (need this here first or else use of "flameshot gui" forks and breaks out of jail
if command -v flameshot > /dev/null 2>&1; then
  flameshot &
fi
