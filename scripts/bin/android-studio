#!/bin/sh

# This needs to be it's own script because
# firejail does not let you pass in environment variables
# to the --env argument

if [ "$(id -u)" -eq 0 ]; then
  printf -- 'Cannot run android-studio as root\n'
  exit 1
fi

if [ -n "$1" ] && [ "$1" = "shell" ]; then
  shift
  exec bww \
    --forcename "android-studio" \
    --shell \
    --nodev \
    --bind-if-exists=/storage/pyamsoft/devel/android \
    --setenv ANDROID_EMULATOR_USE_SYSTEM_LIBS 1 \
    --setenv PATH "/storage/pyamsoft/devel/android/sdk/platform-tools:/opt/android-studio/bin:/opt/android-studio/jre/bin:${SYSTEM_DEFAULT_PATH}" \
    android-studio "$@"
else
  exec bww \
    --forcename "android-studio" \
    --nodev \
    --bind-if-exists=/storage/pyamsoft/devel/android \
    --setenv ANDROID_EMULATOR_USE_SYSTEM_LIBS 1 \
    --setenv PATH "/storage/pyamsoft/devel/android/sdk/platform-tools:/opt/android-studio/bin:/opt/android-studio/jre/bin:${SYSTEM_DEFAULT_PATH}" \
    android-studio "$@"
fi

