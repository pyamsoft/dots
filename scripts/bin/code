#!/bin/sh

# This needs to be it's own script because
# firejail does not let you pass in environment variables
# to the --env argument

if [ "$(id -u)" -eq 0 ]; then
  printf -- 'Cannot run code as root\n'
  exit 1
fi

if [ -n "$1" ] && [ "$1" = "shell" ]; then
  shift
  # Need to run with verbose or it closes
  exec bww \
    --forcename "code" \
    --shell \
    --nodev \
    --bind-if-exists="${HOME}/.config/nvim" \
    --bind-if-exists=/storage/pyamsoft/devel/js \
    code "$@"
else
  # Need to run with verbose or it closes
  exec bww \
    --forcename "code" \
    --nodev \
    --bind-if-exists="${HOME}/.config/nvim" \
    --bind-if-exists=/storage/pyamsoft/devel/js \
    code --verbose "$@"
fi

