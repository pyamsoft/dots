# shellcheck shell=sh

# MacOS doesn't have /usr/local/sbin by default.
# If we made it, add it
if [ "$(uname)" = "Darwin" ]; then
  if [ -d "/usr/local/sbin" ]; then
    PATH="/usr/local/sbin:${PATH}"
  fi  
fi

# Source these onto the path first in case other script
# directories rely on a command we created
#
# ex. .jail/bin relies on our script bin/jail

# Git tracked scripts
if [ -d "${HOME}/bin" ]; then
  PATH="${HOME}/bin:${PATH}"
fi

# Local scripts that are not git tracked
if [ -d "${HOME}/.local/bin" ]; then
  PATH="${HOME}/.local/bin:${PATH}"
fi

# Linux stuff
if [ "$(uname)" = "Linux" ]; then
  # Flatpak scrips
  if command -v flatpak >/dev/null; then
    if [ -d "${HOME}/.flatpak/bin" ]; then
      PATH="${HOME}/.flatpak/bin:${PATH}"
    fi
  fi

  # Jail scripts
  if command -v bwrap >/dev/null && command -v jail >/dev/null; then
    if [ -d "${HOME}/.jail/bin" ]; then
      PATH="${HOME}/.jail/bin:${PATH}"
    fi
  fi
fi

# Docker scrips
if command -v docker >/dev/null || command -v podman >/dev/null; then
  if [ -d "${HOME}/.containers/bin" ]; then
    PATH="${HOME}/.containers/bin:${PATH}"
  fi
fi

# Add local npm repository: used for things like bash-language-server
# Set the local npm global path with "npm config set prefix ~/.npm/global"
if command -v npm >/dev/null; then
  _npm_path="${HOME}/.npm/global"

  # Set the global path
  npm config set prefix "${_npm_path}"

  # Export it
  PATH="${_npm_path}/bin:${PATH}"

  # Clean up
  unset _npm_path
fi

# Export the PATH
export PATH

return 0
