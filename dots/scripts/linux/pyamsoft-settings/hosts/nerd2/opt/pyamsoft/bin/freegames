#!/bin/sh

# Source our common library
. "/opt/pyamsoft/lib/container-launch"

NAME="freegames"
IMAGE="ghcr.io/vogler/free-games-claimer"
TAG="dev"

# Browsers are heavy
CONTAINER_MEMORY_LIMIT="2G"
CONTAINER_PULL_POLICY="newer"

_prep_mounts() {
  _mount_bind "${CONTAINER_RUNTIME_DIR}/${NAME}/data" "/fgc/data" || return 1
  return 0
}

_prep_caps() {
  return 0
}

_prep_ports() {
  # Allow local connection to TurboVNC
  _add_ports -p "127.0.0.1:6080:6080/tcp"
  return 0
}

_prep_env() {
  return 0
}

_prep_network() {
  _network_isolate || return 1
  return 0
}

_check_user() {
  _require_nonroot || return 1

  return 0
}

main "$@" || exit 1
exit 0
