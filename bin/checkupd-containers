#!/bin/sh

main() {
  _count="$1"

  if ! command -v podman >/dev/null; then
    printf -- 'Must install "podman"\n'
    return 1
  fi

  printf -- '(This User) containers:\n'
  podman auto-update --dry-run || return 1

  printf -- '(Containers User) containers:\n'
  containers checkup || return 1

  if [ "$(uname)" != "Darwin" ]; then
    # Check again for root containers
    # We don't do this on MacOS since it runs a VM as root
    printf -- '(Root) containers:\n'
    sudo podman auto-update --dry-run || return 1
  fi

  unset _count
  return 0
}

main "$@" || exit 1
exit 0
