#!/bin/sh

# rofi 2.X
#
# For some reason, new version of rofi 2 which bring Native wayland support break specifically
# on GNOME Wayland, because GNOME does not support the layer-shell protocol (that everyone else does -_-)
#
# To avoid breaking behavior since I like rofi, we use this alias script to force rofi to run
# using X11 backend, instead of Wayland
#
# This script can be dropped-in to places like GNOME keyboard shortcuts

_rofi_wayland_display="${WAYLAND_DISPLAY}"
unset WAYLAND_DISPLAY

# Unset the WAYLAND_DISPLAY so that rofi can run, but re-set it for the executed program
# because we may want to use Wayland
#
# We must do it this way since rofi passes it's environment to the cmd
WAYLAND_DISPLAY='' exec rofi -run-command "env WAYLAND_DISPLAY=${_rofi_wayland_display} {cmd}" "$@"
